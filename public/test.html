<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Key-Value Form</title>
    <style>
        .key, .value {
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <h2>Enter Key-Value Pairs</h2>
    <form id="dynamicForm">
        <input type="text" id="key1" class="key" placeholder="Key" required>
        <input type="text" id="value1" class="value" placeholder="Value" required>
        <button type="button" onclick="removePair('1')">Remove</button>
        <br><br>
        <button type="button" onclick="addPair()">Add Pair</button>
        <br><br>
        <button type="submit">Submit</button>
    </form>

    <h3>Resulting Object:</h3>
    <pre id="result"></pre>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-firestore.js"></script>

    <script>
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID",
            measurementId: "YOUR_MEASUREMENT_ID"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        let pairCount = 1;

        // Function to add a new key-value pair
        function addPair() {
            pairCount++;
            const form = document.getElementById('dynamicForm');
            const keyInput = document.createElement('input');
            keyInput.type = 'text';
            keyInput.id = `key${pairCount}`;
            keyInput.classList.add('key');
            keyInput.placeholder = 'Key';
            keyInput.required = true;

            const valueInput = document.createElement('input');
            valueInput.type = 'text';
            valueInput.id = `value${pairCount}`;
            valueInput.classList.add('value');
            valueInput.placeholder = 'Value';
            valueInput.required = true;

            const removeButton = document.createElement('button');
            removeButton.type = 'button';
            removeButton.textContent = 'Remove';
            removeButton.onclick = () => removePair(pairCount);

            form.insertBefore(keyInput, form.lastElementChild.previousElementSibling);
            form.insertBefore(valueInput, form.lastElementChild.previousElementSibling);
            form.insertBefore(removeButton, form.lastElementChild.previousElementSibling);
            form.insertBefore(document.createElement('br'), form.lastElementChild.previousElementSibling);
        }

        // Function to remove a key-value pair
        function removePair(id) {
            const keyInput = document.getElementById(`key${id}`);
            const valueInput = document.getElementById(`value${id}`);
            const removeButton = keyInput.nextElementSibling;
            const br = removeButton.nextElementSibling;

            keyInput.remove();
            valueInput.remove();
            removeButton.remove();
            br.remove();
        }

        // Handle form submission
        document.getElementById('dynamicForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const pairs = [];
            for (let i = 1; i <= pairCount; i++) {
                const key = document.getElementById(`key${i}`);
                const value = document.getElementById(`value${i}`);
                if (key && value && key.value && value.value) {
                    pairs.push({ key: key.value, value: value.value });
                }
            }

            let resultObject = {};
            pairs.forEach(pair => {
                resultObject[pair.key] = pair.value;
            });

            // Display the resulting object
            document.getElementById('result').textContent = JSON.stringify(resultObject, null, 2);

            // Save the resultObject to Firestore
            db.collection("keyValuePairs").add(resultObject)
                .then(() => {
                    alert("Data saved successfully!");
                })
                .catch((error) => {
                    console.error("Error saving data: ", error);
                });
        });
    </script>
</body>
</html>
